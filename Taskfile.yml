version: '3'

vars:
  GREETING: –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ IT –±–ª–æ–≥!

tasks:
  default:
    cmds:
      - echo "{{.GREETING}}"
      - task --list
    silent: true

  hello:
    desc: –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
    cmds:
      - echo "{{.GREETING}}"
    silent: true

  install:
    desc: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
    cmds:
      - echo "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Hugo —Ç–µ–º—ã PaperMod..."
      - git submodule update --init --recursive
      - echo "‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!"

  serve:
    desc: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
    cmds:
      - hugo server --buildDrafts --buildFuture --disableFastRender

  serve:prod:
    desc: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –≤ production —Ä–µ–∂–∏–º–µ
    cmds:
      - hugo server --environment production --disableFastRender

  build:
    desc: –°–æ–±—Ä–∞—Ç—å —Å–∞–π—Ç –¥–ª—è production
    cmds:
      - echo "üî® –°–±–æ—Ä–∫–∞ —Å–∞–π—Ç–∞..."
      - hugo --gc --minify --cleanDestinationDir
      - echo "‚úÖ –°–∞–π—Ç —Å–æ–±—Ä–∞–Ω –≤ –ø–∞–ø–∫—É ./public"

  build:draft:
    desc: –°–æ–±—Ä–∞—Ç—å —Å–∞–π—Ç –≤–∫–ª—é—á–∞—è —á–µ—Ä–Ω–æ–≤–∏–∫–∏
    cmds:
      - echo "üî® –°–±–æ—Ä–∫–∞ —Å–∞–π—Ç–∞ —Å —á–µ—Ä–Ω–æ–≤–∏–∫–∞–º–∏..."
      - hugo --buildDrafts --gc --minify --cleanDestinationDir
      - echo "‚úÖ –°–∞–π—Ç —Å–æ–±—Ä–∞–Ω –≤ –ø–∞–ø–∫—É ./public"

  clean:
    desc: –û—á–∏—Å—Ç–∏—Ç—å –ø–∞–ø–∫—É public –∏ –∫—ç—à
    cmds:
      - echo "üßπ –û—á–∏—Å—Ç–∫–∞..."
      - rm -rf public/
      - rm -rf resources/
      - hugo mod clean --all || true
      - echo "‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"

  new:
    desc: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: task new -- "–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞")
    cmds:
      - echo "üìù –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç–∞..."
      - hugo new posts/{{.CLI_ARGS | default "new-post"}}.md
      - echo "‚úÖ –ü–æ—Å—Ç —Å–æ–∑–¥–∞–Ω!"

  new:tutorial:
    desc: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç—É—Ç–æ—Ä–∏–∞–ª (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: task new:tutorial -- "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ç–æ—Ä–∏–∞–ª–∞")
    cmds:
      - echo "üöÄ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç—É—Ç–æ—Ä–∏–∞–ª–∞..."
      - hugo new --kind tutorials posts/{{.CLI_ARGS | default "new-tutorial"}}.md
      - echo "‚úÖ –¢—É—Ç–æ—Ä–∏–∞–ª —Å–æ–∑–¥–∞–Ω!"

  new:devops:
    desc: –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç –æ DevOps (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: task new:devops -- "–ù–∞–∑–≤–∞–Ω–∏–µ")
    cmds:
      - echo "‚öôÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ DevOps –ø–æ—Å—Ç–∞..."
      - hugo new posts/{{.CLI_ARGS | default "new-devops-post"}}.md
      - echo "‚úÖ DevOps –ø–æ—Å—Ç —Å–æ–∑–¥–∞–Ω!"

  deploy:
    desc: –î–µ–ø–ª–æ–π –Ω–∞ GitHub Pages
    deps: [build]
    cmds:
      - echo "üöÄ –î–µ–ø–ª–æ–π –Ω–∞ GitHub Pages..."
      - git add .
      - git commit -m "Update site content - {{now | date "2006-01-02 15:04:05"}}" || true
      - git push origin main
      - echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à—ë–Ω!"

  update:
    desc: –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–º—É –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    cmds:
      - echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–º—ã PaperMod..."
      - git submodule update --remote --merge
      - echo "‚úÖ –¢–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!"

  lint:
    desc: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å markdown —Ñ–∞–π–ª—ã
    cmds:
      - echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ markdown —Ñ–∞–π–ª–æ–≤..."
      - markdownlint content/**/*.md || echo "‚ö†Ô∏è  markdownlint –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: npm install -g markdownlint-cli"
      - echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"

  stats:
    desc: –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∞–π—Ç–∞
    cmds:
      - echo "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∞–π—Ç–∞:"
      - echo "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤:" $(find content/posts -name "*.md" | wc -l)
      - echo "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü:" $(find content -name "*.md" -not -path "content/posts/*" | wc -l)
      - echo "–†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏ public:" $(du -sh public/ 2>/dev/null || echo "–Ω–µ —Å–æ–±—Ä–∞–Ω")

  dev:
    desc: –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å–±–æ—Ä–∫–∞ + –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä)
    deps: [clean]
    cmds:
      - task: serve

  check:
    desc: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Å—ã–ª–∫–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    cmds:
      - echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."
      - hugo config | head -20
      - echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–æ–∫..."
      - hugo --printPathWarnings

  backup:
    desc: –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    cmds:
      - echo "üíæ –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞..."
      - tar -czf "backup-content-$(date +%Y%m%d-%H%M%S).tar.gz" content/
      - echo "‚úÖ –ë—ç–∫–∞–ø —Å–æ–∑–¥–∞–Ω!"

  test:
    desc: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∞–π—Ç–∞
    cmds:
      - echo "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞..."
      - hugo --gc --minify --cleanDestinationDir --quiet
      - echo "‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã!"

  docker:build:
    desc: –°–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑ –¥–ª—è —Å–∞–π—Ç–∞
    cmds:
      - echo "üê≥ –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞..."
      - docker build -t it-blog .
      - echo "‚úÖ Docker –æ–±—Ä–∞–∑ —Å–æ–±—Ä–∞–Ω!"

  docker:run:
    desc: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∞–π—Ç –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
    cmds:
      - echo "üê≥ –ó–∞–ø—É—Å–∫ –≤ Docker..."
      - docker run -p 1313:1313 it-blog
      
  help:
    desc: –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
    cmds:
      - echo "üíª IT –ë–ª–æ–≥ - DevOps, –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏"
      - echo ""
      - echo "–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:"
      - echo "  task serve         - –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä"
      - echo "  task build         - –°–æ–±—Ä–∞—Ç—å —Å–∞–π—Ç"
      - echo "  task new           - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç"
      - echo "  task new:tutorial  - –°–æ–∑–¥–∞—Ç—å —Ç—É—Ç–æ—Ä–∏–∞–ª"
      - echo "  task new:devops    - –°–æ–∑–¥–∞—Ç—å DevOps –ø–æ—Å—Ç"
      - echo "  task deploy        - –î–µ–ø–ª–æ–π –Ω–∞ GitHub Pages"
      - echo ""
      - echo "–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥: task --list" 